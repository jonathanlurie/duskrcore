{"version":3,"file":"duskrcore.js","sources":["../src/AdobeXmp.js","../src/AdobeXmpCollection.js","../src/index.js"],"sourcesContent":["import XmlParser from 'xml-js'\n\nclass AdobeXmp {\n\n  /**\n   * Val is a string, but it can represent a number, a boolean or a string.\n   * This function converts val into the most appropriate type.\n   * @param  {string} val - a value\n   * @return {string|number|boolean}\n   */\n  static convertToRelevantType(val){\n    let cleanVal = val.trim()\n    // boolean: true\n    if(cleanVal === 'True' || cleanVal === 'true' || cleanVal === 'TRUE')\n      return true\n\n    // boolean: false\n    if(cleanVal === 'False' || cleanVal === 'false' || cleanVal === 'FALSE')\n      return false\n\n    // a number\n    if(parseFloat(cleanVal) !== NaN)\n      return parseFloat(cleanVal)\n\n    // a string\n    return cleanVal\n  }\n\n\n  static convertToString(val){\n    if(val === true)\n      return 'True'\n\n    if(val === false)\n      return 'False'\n\n    if(typeof val === 'number')\n      return val.toString()\n\n    return val.trim()\n  }\n\n\n\n  constructor(){\n    this._xmlPayload = null\n    this._objectRepresentation = null\n  }\n\n\n  setXmlPayload(xmlStr){\n    this._xmlPayload = xmlStr\n    let jsonPayload = XmlParser.xml2json(xmlStr, {compact: true})\n    this._objectRepresentation = JSON.parse(jsonPayload)\n  }\n\n\n  getXml(){\n    return XmlParser.json2xml(JSON.stringify(this._objectRepresentation), {compact: true, ignoreComment: true, spaces: 4})\n  }\n\n\n  _getBasicAttributesObject(){\n    return this._objectRepresentation['x:xmpmeta']['rdf:RDF']['rdf:Description']['_attributes']\n  }\n\n\n  hasSettings(){\n    let ba = this._getBasicAttributesObject()\n    return ba['crs:HasSettings'] === 'True'\n  }\n\n\n  getRawFileName(){\n    let ba = this._getBasicAttributesObject()\n    return ba['crs:RawFileName']\n  }\n\n\n  setRawFileName(name){\n    let ba = this._getBasicAttributesObject()\n    ba['crs:RawFileName'] = name\n  }\n\n\n  getSettingAttribute(attrName){\n    let ba = this._getBasicAttributesObject()\n    if(`crs:${attrName}` in ba){\n      return AdobeXmp.convertToRelevantType(ba[`crs:${attrName}`])\n    }else{\n      return null\n    }\n  }\n\n\n  setSettingAttribute(attrName, value){\n    let ba = this._getBasicAttributesObject()\n    ba[`crs:${attrName}`] = AdobeXmp.convertToString(value)\n  }\n\n}\n\nexport default AdobeXmp\n","import AdobeXmp from './AdobeXmp'\n\nclass AdobeXmpCollection {\n\n  static findNumberSequence(filename){\n    let splitChar = ' '\n    let numbersOnly = Array.from(filename).map(char => isNaN(parseInt(char)) ? splitChar : char)\n      .join('')\n      .split(splitChar)\n      .filter(substr => substr !== '')\n      .map(substr => parseInt(substr))\n      .filter(substr => substr !== NaN)\n\n    if(numbersOnly.length){\n      let number = numbersOnly[0]\n      let numberPosition = filename.indexOf(number)\n      let prefix = filename.slice(0, numberPosition)\n      let sufix = filename.slice(numberPosition + number.toString().length )\n      return {\n        number: number,\n        prefix: prefix,\n        sufix: sufix\n      }\n    }else{\n      return null\n    }\n  }\n\n  constructor(){\n    this._controlPoints = {}\n  }\n\n\n  addControlPoint(filename, xmlPayload){\n    this._controlPoints[filename] = xmlPayload\n  }\n\n}\n\nexport default AdobeXmpCollection\n","import AdobeXmp from './AdobeXmp'\nimport AdobeXmpCollection from './AdobeXmpCollection'\n\nexport default { AdobeXmp, AdobeXmpCollection }\n"],"names":[],"mappings":"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"}